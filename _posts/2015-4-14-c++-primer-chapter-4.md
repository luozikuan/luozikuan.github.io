---
layout: post
category: c++
title: 《C++ Primer》笔记：第4章
tagline: by Snail
tags: c++ primer
---
《C++ Primer》第4章笔记，表达式。

<!--more-->

# 表达式

## 左值和右值

如果表达式的求值结果是左值，`decltype`作用于该表达式（不是变值）得到一个引用类型。

## 算术运算符

    bool b = true;
    bool b2 = -b;  //b2是true

**新标准：**除了`-m`溢出，其他时候`(-m)/n`和`m/(-n)`都等于`-(m/n)`，`m%(-n)`等于`m%n`，`(-m)%n`等于`-(m%n)`。

## 赋值运算符

初始值列表作为赋值语句右值。

    int k = 0;
    k = {3.14}; //错误：窄化转换

## sizeof运算符

    sizeof (type)
    sizeof expr
    
sizeof并不实际计算其运算对像的值。

## 类型转换

### 何时发生隐式类型转换
 
 * 在大多数表达式中，比int类型小的整型值首先提升为较大的整数类型。
 * 在条件中，非布尔值转换成布尔类型 。
 * 初始化过程中，初始值转换万变量的类型；在赋值语句中，右侧运算对象转换成左侧运算对象的类型。
 * 如果算术运算或关系运算的运算对象有多种类型，需要转换成同一种类型。
 * 函数调用时也会发生类型转换。

### 算术转换

#### 整型提升

负责把小整数类型转换成较大的整数类型 。

#### 无符号类型的运算对象

如果无符号类型不小于带符号类型，那么带符号的运算对象转换成无符号的。

### 其它隐式类型转换

 * 数组转换成指针（decltype、&、sizeof、typeid转换不会发生）
 * 指针的转换：0或者nullptr能转换成任意指针类型；指向的任意非常量的指针能转换成void\*；指向任意对象的指针能转换成const void\*。
 * 转成bool类型
 * 转换成常量
 * 类类型定义的转换

### 显示转换

 * static_cast：不包括底层const
 * const_cast：只转换底层const
 * reinterpret_cast：重新解释
